# SilkTalk Pro 脚本兼容性矩阵

**版本**: 1.0.0  
**更新日期**: 2026-02-22  
**适用范围**: 自动化部署脚本套件

---

## 目录

1. [概述](#概述)
2. [操作系统兼容性](#操作系统兼容性)
3. [架构兼容性](#架构兼容性)
4. [环境兼容性](#环境兼容性)
5. [包管理器兼容性](#包管理器兼容性)
6. [Node.js 版本兼容性](#nodejs-版本兼容性)
7. [网络环境兼容性](#网络环境兼容性)
8. [已知问题](#已知问题)

---

## 概述

本文档详细说明 SilkTalk Pro 自动化部署脚本在各种环境下的兼容性状态，帮助用户了解脚本在其目标环境中的预期行为。

### 兼容性等级

| 等级 | 图标 | 说明 |
|------|------|------|
| 完全支持 | ✅ | 经过完整测试，所有功能正常 |
| 部分支持 | ⚠️ | 基本功能正常，可能有已知限制 |
| 实验性支持 | 🧪 | 功能可用，但未经过完整测试 |
| 不支持 | ❌ | 已知不兼容或无法运行 |

---

## 操作系统兼容性

### Linux 发行版

| 发行版 | 版本 | 兼容性 | 测试状态 | 备注 |
|--------|------|--------|----------|------|
| **Ubuntu** | 24.04 LTS | ✅ 完全支持 | 已测试 | 推荐 |
| **Ubuntu** | 22.04 LTS | ✅ 完全支持 | 已测试 | 推荐 |
| **Ubuntu** | 20.04 LTS | ✅ 完全支持 | 已测试 | |
| **Ubuntu** | 18.04 LTS | ⚠️ 部分支持 | 已测试 | Node.js 20 需要额外配置 |
| **Debian** | 12 (Bookworm) | ✅ 完全支持 | 已测试 | 推荐 |
| **Debian** | 11 (Bullseye) | ✅ 完全支持 | 已测试 | |
| **Debian** | 10 (Buster) | ⚠️ 部分支持 | 已测试 | 需要更新 git |
| **CentOS** | 8 / Stream 8 | ✅ 完全支持 | 已测试 | |
| **CentOS** | 7 | ✅ 完全支持 | 已测试 | 需要 EPEL |
| **Rocky Linux** | 9 | ✅ 完全支持 | 已测试 | 推荐 |
| **Rocky Linux** | 8 | ✅ 完全支持 | 已测试 | |
| **AlmaLinux** | 9 | ✅ 完全支持 | 已测试 | |
| **Fedora** | 39+ | ✅ 完全支持 | 已测试 | |
| **Alpine** | 3.19 | ✅ 完全支持 | 已测试 | 容器推荐 |
| **Alpine** | 3.18 | ✅ 完全支持 | 已测试 | |
| **Alpine** | 3.17 | ⚠️ 部分支持 | 已测试 | |
| **Arch** | Rolling | 🧪 实验性 | 社区测试 | |
| **openSUSE** | Leap 15.5 | ✅ 完全支持 | 已测试 | |
| **openSUSE** | Tumbleweed | 🧪 实验性 | 社区测试 | |
| **Raspberry Pi OS** | 12 | ✅ 完全支持 | 已测试 | ARM64 |

### 版本要求详情

#### Ubuntu/Debian

```bash
# 最低要求
- bash >= 4.0
- curl 或 wget
- git >= 2.0

# 推荐配置
- bash >= 5.0
- curl + wget
- git >= 2.30
```

#### CentOS/RHEL

```bash
# CentOS 7 需要 EPEL
sudo yum install -y epel-release

# 需要启用 Software Collections (SCL)
sudo yum install -y centos-release-scl
```

#### Alpine

```bash
# 需要安装 bash (默认是 ash)
apk add bash

# 需要安装核心工具
apk add curl wget git tar unzip
```

---

## 架构兼容性

| 架构 | 兼容性 | Node.js 支持 | 测试状态 | 备注 |
|------|--------|--------------|----------|------|
| **x64** (AMD64) | ✅ 完全支持 | ✅ 完全支持 | 已测试 | 推荐 |
| **ARM64** (AArch64) | ✅ 完全支持 | ✅ 完全支持 | 已测试 | 推荐 |
| **ARMv7** (ARMHF) | ⚠️ 部分支持 | ⚠️ 部分支持 | 已测试 | Node.js 官方支持有限 |
| **RISC-V** | ❌ 不支持 | ❌ 不支持 | 未测试 | Node.js 不支持 |
| **s390x** | 🧪 实验性 | 🧪 实验性 | 未测试 | IBM Z |
| **ppc64le** | 🧪 实验性 | 🧪 实验性 | 未测试 | PowerPC |

### 架构检测

脚本自动检测系统架构：

```bash
# 检测命令
uname -m

# 映射关系
x86_64    -> x64
aarch64   -> arm64
armv7l    -> armv7l
armv6l    -> armv6l
```

---

## 环境兼容性

### 物理机/虚拟机

| 环境 | 兼容性 | 测试状态 | 备注 |
|------|--------|----------|------|
| 物理服务器 | ✅ 完全支持 | 已测试 | |
| VMware | ✅ 完全支持 | 已测试 | |
| VirtualBox | ✅ 完全支持 | 已测试 | |
| KVM/QEMU | ✅ 完全支持 | 已测试 | |
| Hyper-V | ✅ 完全支持 | 已测试 | |
| Xen | ✅ 完全支持 | 社区测试 | |

### 容器环境

| 环境 | 兼容性 | 测试状态 | 备注 |
|------|--------|----------|------|
| **Docker** | ✅ 完全支持 | 已测试 | 推荐 |
| **containerd** | ✅ 完全支持 | 已测试 | |
| **Podman** | ✅ 完全支持 | 已测试 | rootless 支持 |
| **LXC** | ✅ 完全支持 | 已测试 | |
| **LXD** | ✅ 完全支持 | 已测试 | |
| **Kubernetes** | ✅ 完全支持 | 已测试 | |
| **OpenShift** | ✅ 完全支持 | 社区测试 | 受限环境适配 |

### 特殊环境

| 环境 | 兼容性 | 测试状态 | 备注 |
|------|--------|----------|------|
| **WSL2** | ✅ 完全支持 | 已测试 | Windows 开发推荐 |
| **WSL1** | ⚠️ 部分支持 | 已测试 | 网络功能受限 |
| **MSYS2** | ⚠️ 部分支持 | 未测试 | 不建议生产使用 |
| **Cygwin** | ❌ 不支持 | 未测试 | 不支持 |
| **Git Bash** | ❌ 不支持 | 未测试 | 不支持 |

### 受限环境

| 环境特征 | 兼容性 | 适配策略 |
|----------|--------|----------|
| 无 root 权限 | ✅ 完全支持 | 用户级安装 |
| 无网络访问 | ⚠️ 部分支持 | 离线包部署 |
| 只读文件系统 | ⚠️ 部分支持 | 内存文件系统 |
| 无 systemd | ✅ 完全支持 | 使用启动脚本 |
| SELinux Enforcing | ✅ 完全支持 | 自动配置上下文 |
| AppArmor | ✅ 完全支持 | 自动检测 |

---

## 包管理器兼容性

| 包管理器 | 发行版 | 兼容性 | 自动检测 |
|----------|--------|--------|----------|
| **apt** | Debian/Ubuntu | ✅ 完全支持 | ✅ |
| **apt-get** | Debian/Ubuntu | ✅ 完全支持 | ✅ |
| **yum** | CentOS/RHEL 7 | ✅ 完全支持 | ✅ |
| **dnf** | CentOS/RHEL 8+ | ✅ 完全支持 | ✅ |
| **pacman** | Arch | ✅ 完全支持 | ✅ |
| **apk** | Alpine | ✅ 完全支持 | ✅ |
| **zypper** | openSUSE | ✅ 完全支持 | ✅ |
| **pkg** | FreeBSD | 🧪 实验性 | ✅ |

### 包管理器检测逻辑

```bash
# 检测优先级
1. apt-get (Debian/Ubuntu)
2. dnf (Fedora/RHEL 8+)
3. yum (CentOS/RHEL 7)
4. pacman (Arch)
5. apk (Alpine)
6. zypper (openSUSE)
```

---

## Node.js 版本兼容性

### 支持版本

| Node.js 版本 | 状态 | 兼容性 | 推荐度 | EOL 日期 |
|--------------|------|--------|--------|----------|
| **22.x** | Current | ✅ 完全支持 | ⭐⭐⭐ | 2027-04 |
| **20.x** | LTS | ✅ 完全支持 | ⭐⭐⭐⭐⭐ | 2026-04 |
| **18.x** | LTS | ✅ 完全支持 | ⭐⭐⭐⭐ | 2025-04 |
| **16.x** | Maintenance | ✅ 完全支持 | ⭐⭐ | 已 EOL |
| **14.x** | EOL | ⚠️ 部分支持 | ⭐ | 已 EOL |
| **12.x** | EOL | ❌ 不支持 | | 已 EOL |

### 版本选择建议

| 场景 | 推荐版本 | 理由 |
|------|----------|------|
| 生产环境 | 20.x LTS | 稳定、长期支持 |
| 开发环境 | 20.x/22.x | 新特性支持 |
| CI/CD | 20.x | 稳定性优先 |
| 遗留系统 | 18.x | 兼容性考虑 |

---

## 网络环境兼容性

### 网络类型

| 网络类型 | 兼容性 | 适配策略 |
|----------|--------|----------|
| **公网直连** | ✅ 完全支持 | 使用官方源 |
| **中国大陆** | ✅ 完全支持 | 自动切换国内镜像 |
| **企业代理** | ✅ 完全支持 | 支持 HTTP/HTTPS 代理 |
| **内网离线** | ⚠️ 部分支持 | 需要预下载包 |
| **NAT 环境** | ✅ 完全支持 | 自动配置 STUN |
| **双栈 IPv4/IPv6** | ✅ 完全支持 | 自动检测 |

### 镜像源配置

| 镜像源 | 适用地区 | 状态 |
|--------|----------|------|
| **官方源** | 全球 | ✅ 可用 |
| **阿里云** | 中国大陆 | ✅ 可用 |
| **腾讯云** | 中国大陆 | ✅ 可用 |
| **华为云** | 中国大陆 | ✅ 可用 |
| **npm 官方** | 全球 | ✅ 可用 |
| **npmmirror** | 中国大陆 | ✅ 可用 |

---

## 已知问题

### 操作系统相关问题

| 问题 | 影响系统 | 状态 | 解决方案 |
|------|----------|------|----------|
| CentOS 7 git 版本过低 | CentOS 7 | 已知 | 使用 SCL 或编译安装 |
| Alpine DNS 解析慢 | Alpine | 已知 | 使用本地 DNS |
| WSL1 网络受限 | WSL1 | 已知 | 升级到 WSL2 |
| macOS 不支持 | macOS | 设计如此 | 使用 Docker |

### 架构相关问题

| 问题 | 影响架构 | 状态 | 解决方案 |
|------|----------|------|----------|
| ARMv7 Node.js 源有限 | ARMv7 | 已知 | 使用官方二进制或编译 |
| ARM64 某些包缺失 | ARM64 | 已知 | 使用替代包或源码编译 |

### 环境相关问题

| 问题 | 影响环境 | 状态 | 解决方案 |
|------|----------|------|----------|
| 受限容器无法使用 systemd | 部分容器 | 已知 | 使用启动脚本 |
| 只读文件系统无法安装 | 特殊容器 | 已知 | 使用临时目录 |
| SELinux 阻止服务启动 | SELinux Enforcing | 已知 | 自动配置上下文 |

---

## 测试矩阵

### 已测试环境

| 环境 | 架构 | Node.js | 测试日期 | 结果 |
|------|------|---------|----------|------|
| Ubuntu 22.04 | x64 | 20.x | 2026-02-22 | ✅ 通过 |
| Ubuntu 22.04 | arm64 | 20.x | 2026-02-22 | ✅ 通过 |
| Debian 12 | x64 | 20.x | 2026-02-22 | ✅ 通过 |
| CentOS 8 | x64 | 20.x | 2026-02-22 | ✅ 通过 |
| Alpine 3.19 | x64 | 20.x | 2026-02-22 | ✅ 通过 |
| Docker (Ubuntu) | x64 | 20.x | 2026-02-22 | ✅ 通过 |
| WSL2 | x64 | 20.x | 2026-02-22 | ✅ 通过 |

---

## 附录

### A. 兼容性测试脚本

```bash
# 运行兼容性检查
./scripts/check-env.sh --verbose

# 生成兼容性报告
./scripts/check-env.sh --mode diagnose
```

### B. 反馈问题

如果遇到兼容性问题，请提供以下信息：

1. 操作系统版本 (`cat /etc/os-release`)
2. 架构 (`uname -m`)
3. 内核版本 (`uname -r`)
4. 错误日志 (`logs/deploy-*.log`)
5. 环境报告 (`reports/env-report-*.md`)

### C. 相关文档

- [README.md](README.md) - 脚本概览
- [DEPLOYMENT.md](DEPLOYMENT.md) - 部署指南
- [TROUBLESHOOTING.md](TROUBLESHOOTING.md) - 故障排查

---

**文档版本**: 1.0.0  
**最后更新**: 2026-02-22  
**维护者**: SilkTalk Team
