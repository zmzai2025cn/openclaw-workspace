# SilkTalk Pro 环境兼容性矩阵

## 操作系统支持

### Linux 发行版

| 发行版 | 版本 | 支持状态 | 包管理器 | 备注 |
|--------|------|----------|----------|------|
| Ubuntu | 20.04 LTS | ✅ 完全支持 | apt | 推荐 |
| Ubuntu | 22.04 LTS | ✅ 完全支持 | apt | 推荐 |
| Ubuntu | 24.04 LTS | ✅ 完全支持 | apt | 推荐 |
| Debian | 11 (Bullseye) | ✅ 完全支持 | apt | |
| Debian | 12 (Bookworm) | ✅ 完全支持 | apt | 推荐 |
| CentOS | 8 / Stream | ✅ 完全支持 | yum/dnf | |
| Rocky Linux | 8+ | ✅ 完全支持 | dnf | |
| AlmaLinux | 8+ | ✅ 完全支持 | dnf | |
| Fedora | 38+ | ✅ 完全支持 | dnf | |
| Arch Linux | Rolling | ✅ 完全支持 | pacman | |
| Manjaro | Rolling | ✅ 完全支持 | pacman | |
| Alpine | 3.16+ | ✅ 支持 | apk | 需 build-base |
| openSUSE | 15+ | ✅ 支持 | zypper | |
| Raspbian | 11+ | ✅ 支持 | apt | ARM 架构 |

### 容器环境

| 环境 | 支持状态 | 检测方法 | 适配策略 |
|------|----------|----------|----------|
| Docker | ✅ 完全支持 | /.dockerenv | 容器内检测 |
| containerd | ✅ 支持 | /proc/1/cgroup | 受限模式 |
| LXC/LXD | ✅ 支持 | /proc/vz | 受限模式 |
| Podman | ✅ 支持 | 环境变量 | 同 Docker |
| Kubernetes | ✅ 支持 | KUBERNETES_SERVICE_HOST | 容器适配 |

### Windows 子系统

| 环境 | 支持状态 | 检测方法 | 备注 |
|------|----------|----------|------|
| WSL2 | ✅ 完全支持 | /proc/version | 推荐 |
| WSL1 | ⚠️ 有限支持 | /proc/version | 可能有网络问题 |
| MSYS2 | ✅ 支持 | uname | 需手动安装 |
| Cygwin | ⚠️ 有限支持 | uname | 不推荐 |

## 架构支持

| 架构 | 支持状态 | Node.js 支持 | 二进制可用 |
|------|----------|--------------|------------|
| x64 (amd64) | ✅ 完全支持 | ✅ | ✅ |
| ARM64 (aarch64) | ✅ 完全支持 | ✅ | ✅ |
| ARMv7 (armhf) | ✅ 支持 | ✅ | ⚠️ 需编译 |
| x86 (i386) | ⚠️ 有限支持 | ⚠️ | ❌ |
| RISC-V | ❌ 不支持 | ❌ | ❌ |

## Node.js 版本兼容性

| Node.js 版本 | 支持状态 | 推荐 | 备注 |
|--------------|----------|------|------|
| 18.x LTS | ✅ 支持 | ⚠️ | 最低要求 |
| 20.x LTS | ✅ 支持 | ✅ | 推荐 |
| 21.x | ✅ 支持 | | 最新特性 |
| 22.x | ✅ 支持 | | 实验性支持 |
| 16.x | ❌ 不支持 | | 已弃用 |
| < 16 | ❌ 不支持 | | 不支持 |

## 网络环境

| 网络类型 | 支持状态 | 检测方法 | 适配策略 |
|----------|----------|----------|----------|
| 公网 | ✅ 完全支持 | IP 检测 | 标准部署 |
| 内网/NAT | ✅ 支持 | IP 段检测 | STUN/TURN |
| 受限网络 | ✅ 支持 | 连通性测试 | 中继模式 |
| 无网络 | ⚠️ 有限支持 | ping 测试 | 离线模式 |
| IPv6 | ✅ 支持 | /proc/net/if_inet6 | 双栈支持 |
| 仅 IPv4 | ✅ 支持 | 检测 | 标准模式 |

## 权限模式

| 权限级别 | 支持状态 | 安装路径 | 适配策略 |
|----------|----------|----------|----------|
| root | ✅ 完全支持 | /usr/local | 系统级安装 |
| sudo | ✅ 完全支持 | /usr/local | 系统级安装 |
| 普通用户 | ✅ 支持 | ~/.local | 用户级安装 |
| 受限用户 | ⚠️ 有限支持 | ~/silktalk | 最小化部署 |

## 依赖要求

### 必需依赖

| 依赖 | 用途 | 自动安装 |
|------|------|----------|
| curl | 下载 | ✅ |
| wget | 下载 | ✅ |
| git | 版本控制 | ✅ |
| tar | 解压 | ✅ |
| unzip | 解压 | ✅ |

### 构建依赖

| 依赖 | 用途 | 自动安装 |
|------|------|----------|
| gcc/g++ | 原生模块编译 | ✅ |
| make | 构建工具 | ✅ |
| python3 | 节点编译 | ✅ |
| libssl-dev | TLS 支持 | ✅ |

## 资源要求

| 资源 | 最低 | 推荐 | 说明 |
|------|------|------|------|
| CPU | 1 核 | 2 核 | 支持并发 |
| 内存 | 512 MB | 2 GB | 影响并发数 |
| 磁盘 | 1 GB | 5 GB | 含日志空间 |
| 网络 | 1 Mbps | 10 Mbps | 影响通话质量 |

## 防火墙端口

| 端口 | 协议 | 用途 | 必需 |
|------|------|------|------|
| 3000 | TCP | HTTP API | ✅ |
| 3001 | TCP | WebSocket | ✅ |
| 3478 | UDP | STUN | ✅ |
| 5349 | TCP/UDP | TURN | ⚠️ 中继时需要 |
| 10000-20000 | UDP | WebRTC | ⚠️ 大范围端口 |

## 已知限制

### 当前限制

1. **WSL1**: 网络性能受限，建议使用 WSL2
2. **Alpine**: 需要安装 build-base 以编译原生模块
3. **ARMv7**: 部分依赖可能需要手动编译
4. **受限容器**: 可能无法使用某些系统调用

### 计划支持

- [ ] FreeBSD 支持
- [ ] macOS 原生支持
- [ ] 更多架构优化

## 测试矩阵

| 环境 | 测试状态 | 最后测试 |
|------|----------|----------|
| Ubuntu 22.04 x64 | ✅ 通过 | 2024-XX |
| Debian 12 x64 | ✅ 通过 | 2024-XX |
| Alpine 3.18 x64 | ✅ 通过 | 2024-XX |
| Ubuntu 22.04 ARM64 | ✅ 通过 | 2024-XX |
| Docker (Alpine) | ✅ 通过 | 2024-XX |
| WSL2 Ubuntu | ✅ 通过 | 2024-XX |
